<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generate 6-Month Forecast System</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        gap: 2rem;
      }

      .form-container,
      .result-container {
        background: white;
        padding: 2.5rem;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow: hidden;
      }

      .form-container::before,
      .result-container::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
      }

      .form-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .form-header h1 {
        color: #2c3e50;
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .form-header .icon {
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        font-size: 2.2rem;
      }

      .form-row {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 1.5rem;
        margin-bottom: 1.5rem;
      }

      .form-group {
        margin-bottom: 1.5rem;
      }

      .form-group label {
        display: block;
        margin-bottom: 0.5rem;
        color: #34495e;
        font-weight: 600;
        font-size: 0.95rem;
      }

      .form-control {
        width: 100%;
        padding: 0.875rem 1rem;
        border: 2px solid #e1e8ed;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background-color: #f8f9fa;
      }

      .form-control:focus {
        outline: none;
        border-color: #667eea;
        background-color: white;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .input-group {
        position: relative;
      }

      .input-group .form-control {
        padding-right: 3rem;
      }

      .input-suffix {
        position: absolute;
        right: 1rem;
        top: 50%;
        transform: translateY(-50%);
        color: #7f8c8d;
        font-weight: 600;
        pointer-events: none;
      }

      .btn {
        width: 100%;
        padding: 1rem;
        border: none;
        border-radius: 10px;
        font-size: 1.1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
      }

      .btn-primary {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-primary:hover:not(:disabled) {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
      }

      .btn:disabled {
        background: #bdc3c7;
        cursor: not-allowed;
        transform: none;
        box-shadow: none;
      }

      .result-container {
        display: none;
      }

      .result-container.show {
        display: block;
        animation: slideIn 0.5s ease-out;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .result-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .result-header h2 {
        color: #2c3e50;
        font-size: 1.8rem;
        margin-bottom: 0.5rem;
      }

      .chart-container {
        background: white;
        padding: 2rem;
        border-radius: 15px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
        position: relative;
      }

      .chart-header {
        text-align: center;
        margin-bottom: 2rem;
      }

      .chart-header h3 {
        color: #2c3e50;
        font-size: 1.3rem;
        margin-bottom: 0.5rem;
      }

      .chart-canvas {
        position: relative;
        height: 400px;
        width: 100%;
      }

      .forecast-cards-toggle {
        display: flex;
        justify-content: center;
        gap: 1rem;
        margin-bottom: 2rem;
      }

      .toggle-btn {
        padding: 0.5rem 1rem;
        border: 2px solid #667eea;
        background: white;
        color: #667eea;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-weight: 600;
      }

      .toggle-btn.active {
        background: #667eea;
        color: white;
      }

      .toggle-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      }

      .forecast-grid {
        display: none;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
      }

      .forecast-grid.show {
        display: grid;
      }

      .month-forecast-card {
        background: linear-gradient(135deg, #667eea, #764ba2);
        color: white;
        padding: 1.5rem;
        border-radius: 15px;
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .month-forecast-card::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        transform: translate(20px, -20px);
      }

      .month-name {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 0.5rem;
      }

      .prediction-value {
        font-size: 1.8rem;
        font-weight: 700;
        margin: 0.5rem 0;
      }

      .base-info {
        font-size: 0.85rem;
        opacity: 0.9;
      }

      .summary-section {
        background: #f8f9fa;
        padding: 2rem;
        border-radius: 15px;
        margin-bottom: 2rem;
      }

      .summary-header {
        text-align: center;
        margin-bottom: 1.5rem;
      }

      .summary-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1rem;
      }

      .stat-card {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        text-align: center;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: 700;
        color: #667eea;
        margin-bottom: 0.5rem;
      }

      .stat-label {
        color: #7f8c8d;
        font-size: 0.9rem;
      }

      .data-source-info {
        background: #fff3cd;
        color: #856404;
        padding: 1rem;
        border-radius: 8px;
        border-left: 4px solid #ffc107;
        margin-bottom: 1.5rem;
      }

      .loading-spinner {
        display: none;
        width: 20px;
        height: 20px;
        border: 2px solid rgba(255, 255, 255, 0.3);
        border-radius: 50%;
        border-top-color: white;
        animation: spin 0.8s ease-in-out infinite;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      .btn.loading .loading-spinner {
        display: block;
      }

      .btn.loading .btn-text {
        display: none;
      }

      .calculation-details {
        background: white;
        padding: 1.5rem;
        border-radius: 12px;
        margin-top: 1rem;
      }

      .calculation-details h4 {
        color: #2c3e50;
        margin-bottom: 1rem;
        text-align: center;
      }

      .calculation-table {
        width: 100%;
        border-collapse: collapse;
        font-size: 0.9rem;
      }

      .calculation-table th,
      .calculation-table td {
        padding: 0.75rem;
        text-align: left;
        border-bottom: 1px solid #e1e8ed;
      }

      .calculation-table th {
        background: #f8f9fa;
        font-weight: 600;
        color: #2c3e50;
      }

      .calculation-table tr:hover {
        background: #f8f9fa;
      }

      @media (max-width: 768px) {
        .container {
          padding: 0 10px;
        }

        .form-container,
        .result-container {
          padding: 1.5rem;
        }

        .form-row {
          grid-template-columns: 1fr;
          gap: 1rem;
        }

        .forecast-grid {
          grid-template-columns: 1fr;
        }

        .summary-stats {
          grid-template-columns: 1fr;
        }

        .calculation-table {
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- Forecast Generation Form -->
      <div class="form-container">
        <div class="form-header">
          <h1>
            <i class="fas fa-chart-line icon"></i>
            Generate 6-Month Forecast
          </h1>
          <p>
            Select starting month and growth percentage to generate 6-month
            sales forecast
          </p>
        </div>

        <form id="forecastForm">
          <div class="form-row">
            <div class="form-group">
              <label for="monthSelect">
                <i class="fas fa-calendar-alt"></i> Starting Month
              </label>
              <select id="monthSelect" class="form-control" required>
                <option value="">Select starting month...</option>
                <option value="1">January</option>
                <option value="2">February</option>
                <option value="3">March</option>
                <option value="4">April</option>
                <option value="5">May</option>
                <option value="6">June</option>
                <option value="7">July</option>
                <option value="8">August</option>
                <option value="9">September</option>
                <option value="10">October</option>
                <option value="11">November</option>
                <option value="12">December</option>
              </select>
            </div>

            <div class="form-group">
              <label for="percentageInput">
                <i class="fas fa-percentage"></i> Growth Percentage
              </label>
              <div class="input-group">
                <input
                  type="number"
                  id="percentageInput"
                  class="form-control"
                  placeholder="Enter growth percentage"
                  min="-100"
                  max="1000"
                  step="0.01"
                  required
                />
                <span class="input-suffix">%</span>
              </div>
            </div>
          </div>

          <small
            style="
              color: #7f8c8d;
              margin-bottom: 1.5rem;
              display: block;
              text-align: center;
            "
          >
            System will generate forecasts for 6 consecutive months starting
            from selected month
          </small>

          <button type="submit" id="submitBtn" class="btn btn-primary" disabled>
            <div class="loading-spinner"></div>
            <span class="btn-text">
              <i class="fas fa-magic"></i>
              Generate 6-Month Forecast
            </span>
          </button>
        </form>
      </div>

      <!-- Results Container -->
      <div class="result-container" id="resultContainer">
        <div class="result-header">
          <h2><i class="fas fa-crystal-ball"></i> 6-Month Forecast Results</h2>
          <p>Forecast period: <span id="forecastPeriod"></span></p>
        </div>

        <div class="data-source-info" id="dataSourceInfo">
          <i class="fas fa-info-circle"></i>
          <span id="dataSourceText"></span>
        </div>

        <!-- Chart Container -->
        <div class="chart-container">
          <div class="chart-header">
            <h3>
              <i class="fas fa-chart-line"></i> 6-Month Forecast Visualization
            </h3>
            <p>Visual representation of predicted vs base values</p>
          </div>
          <div class="chart-canvas">
            <canvas id="forecastChart"></canvas>
          </div>
        </div>

        <!-- Toggle between Chart and Cards -->
        <div class="forecast-cards-toggle">
          <button class="toggle-btn active" id="chartViewBtn">
            <i class="fas fa-chart-line"></i> Chart View
          </button>
          <button class="toggle-btn" id="cardsViewBtn">
            <i class="fas fa-th-large"></i> Cards View
          </button>
        </div>

        <div class="forecast-grid" id="forecastGrid">
          <!-- Month forecast cards will be generated here -->
        </div>

        <div class="summary-section">
          <div class="summary-header">
            <h3><i class="fas fa-chart-bar"></i> Forecast Summary</h3>
          </div>
          <div class="summary-stats">
            <div class="stat-card">
              <div class="stat-value" id="totalForecast">$0</div>
              <div class="stat-label">Total 6-Month Forecast</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="avgMonthly">$0</div>
              <div class="stat-label">Average Monthly</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="totalGrowth">$0</div>
              <div class="stat-label">Total Growth Amount</div>
            </div>
            <div class="stat-card">
              <div class="stat-value" id="highestMonth">-</div>
              <div class="stat-label">Highest Month</div>
            </div>
          </div>

          <div class="calculation-details">
            <h4><i class="fas fa-table"></i> Detailed Calculation Breakdown</h4>
            <table class="calculation-table" id="calculationTable">
              <thead>
                <tr>
                  <th>Month</th>
                  <th>Base Value</th>
                  <th>Growth %</th>
                  <th>Growth Amount</th>
                  <th>Predicted Value</th>
                  <th>Data Source</th>
                </tr>
              </thead>
              <tbody id="calculationTableBody">
                <!-- Calculation rows will be generated here -->
              </tbody>
            </table>
          </div>
        </div>

        <button class="btn btn-primary" onclick="resetForm()">
          <i class="fas fa-plus"></i>
          Create New Forecast
        </button>
      </div>
    </div>

    <script>
      class SixMonthForecastGenerator {
        constructor() {
          this.form = document.getElementById("forecastForm");
          this.monthSelect = document.getElementById("monthSelect");
          this.percentageInput = document.getElementById("percentageInput");
          this.submitBtn = document.getElementById("submitBtn");
          this.resultContainer = document.getElementById("resultContainer");
          this.forecastChart = null;

          // Mock database - In real application, this would be API calls
          this.salesData = this.generateMockSalesData();

          this.monthNames = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December",
          ];

          this.init();
        }

        init() {
          this.setupEventListeners();
          this.validateForm();
          this.setupViewToggle();
        }

        generateMockSalesData() {
          const data = {};
          const currentDate = new Date();

          // Generate 36 months of mock data (3 years for better coverage)
          for (
            let year = currentDate.getFullYear() - 2;
            year <= currentDate.getFullYear();
            year++
          ) {
            data[year] = {};
            for (let month = 1; month <= 12; month++) {
              // Skip future months in current year
              if (
                year === currentDate.getFullYear() &&
                month > currentDate.getMonth() + 1
              ) {
                continue;
              }

              // Generate realistic sales data with seasonal variation
              const baseValue =
                45000 + Math.sin(((month - 1) * Math.PI) / 6) * 25000;
              const yearGrowth =
                (year - (currentDate.getFullYear() - 2)) * 5000;
              const randomVariation = (Math.random() - 0.5) * 15000;
              data[year][month] = Math.max(
                15000,
                Math.round(baseValue + yearGrowth + randomVariation)
              );
            }
          }

          return data;
        }

        setupEventListeners() {
          this.monthSelect.addEventListener("change", () => {
            this.validateForm();
          });

          this.percentageInput.addEventListener("input", () => {
            this.validateForm();
          });

          this.form.addEventListener("submit", (e) => {
            e.preventDefault();
            this.generateSixMonthForecast();
          });
        }

        setupViewToggle() {
          const chartViewBtn = document.getElementById("chartViewBtn");
          const cardsViewBtn = document.getElementById("cardsViewBtn");
          const forecastGrid = document.getElementById("forecastGrid");

          chartViewBtn.addEventListener("click", () => {
            chartViewBtn.classList.add("active");
            cardsViewBtn.classList.remove("active");
            forecastGrid.classList.remove("show");
          });

          cardsViewBtn.addEventListener("click", () => {
            cardsViewBtn.classList.add("active");
            chartViewBtn.classList.remove("active");
            forecastGrid.classList.add("show");
          });
        }

        validateForm() {
          const monthValid = this.monthSelect.value !== "";
          const percentageValid =
            this.percentageInput.value !== "" &&
            !isNaN(parseFloat(this.percentageInput.value));

          this.submitBtn.disabled = !(monthValid && percentageValid);
        }

        async generateSixMonthForecast() {
          this.submitBtn.classList.add("loading");
          this.submitBtn.disabled = true;

          try {
            // Simulate API processing time
            await new Promise((resolve) => setTimeout(resolve, 2000));

            const startMonth = parseInt(this.monthSelect.value);
            const percentage = parseFloat(this.percentageInput.value);
            const currentYear = new Date().getFullYear();

            const forecasts = this.calculateSixMonthForecast(
              startMonth,
              currentYear,
              percentage
            );
            this.displayResults(forecasts, startMonth, currentYear, percentage);
          } catch (error) {
            console.error("Error generating forecast:", error);
            this.showError("Failed to generate forecast. Please try again.");
          } finally {
            this.submitBtn.classList.remove("loading");
            this.validateForm();
          }
        }

        calculateSixMonthForecast(startMonth, startYear, percentage) {
          const forecasts = [];

          for (let i = 0; i < 6; i++) {
            let currentMonth = startMonth + i;
            let currentYear = startYear;

            // Handle year transition
            while (currentMonth > 12) {
              currentMonth -= 12;
              currentYear += 1;
            }

            const forecast = this.calculateSingleMonthForecast(
              currentMonth,
              currentYear,
              percentage
            );
            forecasts.push({
              month: currentMonth,
              year: currentYear,
              monthName: this.monthNames[currentMonth - 1],
              ...forecast,
            });
          }

          return forecasts;
        }

        calculateSingleMonthForecast(month, year, percentage) {
          const currentMonthSales = this.salesData[year]?.[month];
          const lastYearSameMonthSales = this.salesData[year - 1]?.[month];

          let baseValue, dataSource;

          if (
            currentMonthSales !== undefined &&
            lastYearSameMonthSales !== undefined
          ) {
            // Both values exist, use the larger one
            baseValue = Math.max(currentMonthSales, lastYearSameMonthSales);
            dataSource =
              baseValue === currentMonthSales
                ? `Current year data`
                : `Last year data`;
          } else if (currentMonthSales !== undefined) {
            // Only current year data exists
            baseValue = currentMonthSales;
            dataSource = `Current year data`;
          } else if (lastYearSameMonthSales !== undefined) {
            // Only last year data exists
            baseValue = lastYearSameMonthSales;
            dataSource = `Last year data`;
          } else {
            // No data for this month, find most recent data
            const recentData = this.findMostRecentSalesData(month, year);
            baseValue = recentData.value;
            dataSource = `Recent data (${
              this.monthNames[recentData.month - 1]
            } ${recentData.year})`;
          }

          const growthAmount = baseValue * (percentage / 100);
          const predictedValue = baseValue + growthAmount;

          return {
            baseValue,
            growthAmount,
            predictedValue,
            dataSource,
          };
        }

        findMostRecentSalesData(targetMonth, targetYear) {
          // Search backwards from target month to find the most recent data
          for (let monthOffset = 1; monthOffset <= 36; monthOffset++) {
            let searchMonth = targetMonth - monthOffset;
            let searchYear = targetYear;

            while (searchMonth <= 0) {
              searchMonth += 12;
              searchYear -= 1;
            }

            if (this.salesData[searchYear]?.[searchMonth] !== undefined) {
              return {
                value: this.salesData[searchYear][searchMonth],
                month: searchMonth,
                year: searchYear,
              };
            }
          }

          // Fallback to default value
          return {
            value: 50000,
            month: targetMonth,
            year: targetYear - 1,
          };
        }

        displayResults(forecasts, startMonth, startYear, percentage) {
          // Display forecast period
          const endMonth =
            startMonth + 5 > 12 ? startMonth + 5 - 12 : startMonth + 5;
          const endYear = startMonth + 5 > 12 ? startYear + 1 : startYear;

          document.getElementById("forecastPeriod").textContent = `${
            this.monthNames[startMonth - 1]
          } ${startYear} - ${this.monthNames[endMonth - 1]} ${endYear}`;

          // Generate line chart
          this.generateForecastChart(forecasts);

          // Generate month forecast cards
          this.generateForecastCards(forecasts);

          // Generate summary statistics
          this.generateSummaryStats(forecasts, percentage);

          // Generate calculation table
          this.generateCalculationTable(forecasts, percentage);

          // Show data source info
          document.getElementById(
            "dataSourceText"
          ).textContent = `Forecasts calculated using historical sales data with ${percentage}% growth rate applied to each month`;

          // Show results
          this.resultContainer.classList.add("show");
          this.resultContainer.scrollIntoView({ behavior: "smooth" });
        }

        generateForecastChart(forecasts) {
          const ctx = document.getElementById("forecastChart").getContext("2d");

          // Destroy existing chart if it exists
          if (this.forecastChart) {
            this.forecastChart.destroy();
          }

          const labels = forecasts.map(
            (f) => `${f.monthName.substring(0, 3)} ${f.year}`
          );
          const baseValues = forecasts.map((f) => f.baseValue);
          const predictedValues = forecasts.map((f) => f.predictedValue);
          const growthAmounts = forecasts.map((f) => f.growthAmount);

          this.forecastChart = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Base Value",
                  data: baseValues,
                  borderColor: "#94a3b8",
                  backgroundColor: "rgba(148, 163, 184, 0.1)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.4,
                  pointBackgroundColor: "#94a3b8",
                  pointBorderColor: "#ffffff",
                  pointBorderWidth: 2,
                  pointRadius: 6,
                  pointHoverRadius: 8,
                },
                {
                  label: "Predicted Value",
                  data: predictedValues,
                  borderColor: "#667eea",
                  backgroundColor: "rgba(102, 126, 234, 0.1)",
                  borderWidth: 3,
                  fill: true,
                  tension: 0.4,
                  pointBackgroundColor: "#667eea",
                  pointBorderColor: "#ffffff",
                  pointBorderWidth: 2,
                  pointRadius: 8,
                  pointHoverRadius: 10,
                },
                {
                  label: "Growth Amount",
                  data: growthAmounts,
                  borderColor: "#10b981",
                  backgroundColor: "rgba(16, 185, 129, 0.1)",
                  borderWidth: 2,
                  fill: false,
                  tension: 0.4,
                  pointBackgroundColor: "#10b981",
                  pointBorderColor: "#ffffff",
                  pointBorderWidth: 2,
                  pointRadius: 5,
                  pointHoverRadius: 7,
                  yAxisID: "y1",
                },
              ],
            },
            options: {
              responsive: true,
              maintainAspectRatio: false,
              interaction: {
                mode: "index",
                intersect: false,
              },
              plugins: {
                legend: {
                  position: "top",
                  labels: {
                    usePointStyle: true,
                    padding: 20,
                    font: {
                      size: 12,
                      weight: "600",
                    },
                  },
                },
                tooltip: {
                  backgroundColor: "rgba(0, 0, 0, 0.8)",
                  titleColor: "#ffffff",
                  bodyColor: "#ffffff",
                  borderColor: "#667eea",
                  borderWidth: 1,
                  cornerRadius: 8,
                  displayColors: true,
                  callbacks: {
                    label: function (context) {
                      const label = context.dataset.label;
                      const value = context.parsed.y;
                      return `${label}: ${new Intl.NumberFormat("en-US", {
                        style: "currency",
                        currency: "USD",
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0,
                      }).format(value)}`;
                    },
                  },
                },
              },
              scales: {
                x: {
                  display: true,
                  title: {
                    display: true,
                    text: "Months",
                    color: "#374151",
                    font: {
                      size: 14,
                      weight: "600",
                    },
                  },
                  grid: {
                    display: true,
                    color: "rgba(0, 0, 0, 0.1)",
                  },
                  ticks: {
                    color: "#6b7280",
                    font: {
                      size: 11,
                      weight: "500",
                    },
                  },
                },
                y: {
                  type: "linear",
                  display: true,
                  position: "left",
                  title: {
                    display: true,
                    text: "Sales Value ($)",
                    color: "#374151",
                    font: {
                      size: 14,
                      weight: "600",
                    },
                  },
                  grid: {
                    display: true,
                    color: "rgba(0, 0, 0, 0.1)",
                  },
                  ticks: {
                    color: "#6b7280",
                    font: {
                      size: 11,
                      weight: "500",
                    },
                    callback: function (value) {
                      return new Intl.NumberFormat("en-US", {
                        style: "currency",
                        currency: "USD",
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0,
                        notation: "compact",
                      }).format(value);
                    },
                  },
                },
                y1: {
                  type: "linear",
                  display: true,
                  position: "right",
                  title: {
                    display: true,
                    text: "Growth Amount ($)",
                    color: "#10b981",
                    font: {
                      size: 12,
                      weight: "600",
                    },
                  },
                  grid: {
                    drawOnChartArea: false,
                  },
                  ticks: {
                    color: "#10b981",
                    font: {
                      size: 10,
                      weight: "500",
                    },
                    callback: function (value) {
                      return new Intl.NumberFormat("en-US", {
                        style: "currency",
                        currency: "USD",
                        minimumFractionDigits: 0,
                        maximumFractionDigits: 0,
                        notation: "compact",
                      }).format(value);
                    },
                  },
                },
              },
              elements: {
                line: {
                  borderJoinStyle: "round",
                },
                point: {
                  hoverBorderWidth: 3,
                },
              },
              animation: {
                duration: 2000,
                easing: "easeInOutQuart",
              },
            },
          });
        }

        generateForecastCards(forecasts) {
          const forecastGrid = document.getElementById("forecastGrid");
          forecastGrid.innerHTML = "";

          forecasts.forEach((forecast) => {
            const card = document.createElement("div");
            card.className = "month-forecast-card";
            card.innerHTML = `
                        <div class="month-name">${forecast.monthName} ${
              forecast.year
            }</div>
                        <div class="prediction-value">${this.formatCurrency(
                          forecast.predictedValue
                        )}</div>
                        <div class="base-info">Base: ${this.formatCurrency(
                          forecast.baseValue
                        )}</div>
                        <div class="base-info">Source: ${
                          forecast.dataSource
                        }</div>
                    `;
            forecastGrid.appendChild(card);
          });
        }

        generateSummaryStats(forecasts, percentage) {
          const totalForecast = forecasts.reduce(
            (sum, f) => sum + f.predictedValue,
            0
          );
          const totalBase = forecasts.reduce((sum, f) => sum + f.baseValue, 0);
          const totalGrowth = totalForecast - totalBase;
          const avgMonthly = totalForecast / 6;

          const highestForecast = forecasts.reduce((max, f) =>
            f.predictedValue > max.predictedValue ? f : max
          );

          document.getElementById("totalForecast").textContent =
            this.formatCurrency(totalForecast);
          document.getElementById("avgMonthly").textContent =
            this.formatCurrency(avgMonthly);
          document.getElementById("totalGrowth").textContent =
            this.formatCurrency(totalGrowth);
          document.getElementById(
            "highestMonth"
          ).textContent = `${highestForecast.monthName} ${highestForecast.year}`;
        }

        generateCalculationTable(forecasts, percentage) {
          const tableBody = document.getElementById("calculationTableBody");
          tableBody.innerHTML = "";

          forecasts.forEach((forecast) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                        <td><strong>${forecast.monthName} ${
              forecast.year
            }</strong></td>
                        <td>${this.formatCurrency(forecast.baseValue)}</td>
                        <td>${percentage}%</td>
                        <td>${this.formatCurrency(forecast.growthAmount)}</td>
                        <td><strong>${this.formatCurrency(
                          forecast.predictedValue
                        )}</strong></td>
                        <td>${forecast.dataSource}</td>
                    `;
            tableBody.appendChild(row);
          });
        }

        formatCurrency(amount) {
          return new Intl.NumberFormat("en-US", {
            style: "currency",
            currency: "USD",
            minimumFractionDigits: 0,
            maximumFractionDigits: 0,
          }).format(Math.round(amount));
        }

        showError(message) {
          console.error(message);
          // Add error display logic here
        }
      }

      // Global functions
      function resetForm() {
        document.getElementById("forecastForm").reset();
        document.getElementById("resultContainer").classList.remove("show");
        forecastGenerator.validateForm();
      }

      // Initialize the system
      let forecastGenerator;
      document.addEventListener("DOMContentLoaded", () => {
        forecastGenerator = new SixMonthForecastGenerator();
      });
    </script>
  </body>
</html>
